projects:
  - name: gcphde-prim-dev-data
    bindings:
      - principal: serviceAccount:sa-data-team-specific@gcphde-prim-dev-data.iam.gserviceaccount.com
        roles:
          - roles/bigquery.jobUser
          - roles/bigquery.user
          - roles/bigquery.dataEditor
          - roles/storage.admin
          - roles/cloudfunctions.admin
          - roles/dataflow.developer
      - principal: serviceAccount:sa-function-runner@gcphde-prim-dev-data.iam.gserviceaccount.com
        roles:
          - roles/cloudfunctions.viewer
          - roles/logging.viewer
          - roles/dataflow.developer
      - principal: serviceAccount:sa-pubsub-dataflow@gcphde-prim-dev-data.iam.gserviceaccount.com
        roles:
          - roles/storage.objectAdmin
          - roles/storage.admin
          - roles/cloudfunctions.admin
          - roles/dataflow.developer
      - principal: serviceAccount:sa-schedule-runner@gcphde-prim-dev-data.iam.gserviceaccount.com
        roles:
          - roles/bigquery.dataEditor
          - roles/cloudfunctions.admin
    conditional:
      - roles: roles/storage.objectAdmin
        title: write_non_dataflow_buckets
        description: can have edit access on all buckets the dataflow ones
        expression: "!resource.name.startsWith(\"projects/_/buckets/dataflow-\")"
        members:
         - serviceAccount:sa-function-runner@gcphde-prim-dev-data.iam.gserviceaccount.com
      - roles: roles/storage.objectViewer
        title: read_non_dataflow_buckets
        description: can have read access on all buckets the dataflow ones
        expression: "!resource.name.startsWith(\"projects/_/buckets/dataflow-\")"
        members:
          - serviceAccount:sa-data-team-specific@gcphde-prim-dev-data.iam.gserviceaccount.com

